# Agent

åœ¨äººå·¥æ™ºèƒ½é¢†åŸŸï¼Œ**Agentï¼ˆæ™ºèƒ½ä½“ï¼‰** æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œä»£è¡¨äº† AI ä»å•çº¯çš„â€œæ„ŸçŸ¥ä¸ç†è§£â€å‘â€œè‡ªä¸»å†³ç­–ä¸è¡ŒåŠ¨â€çš„è·¨è¶Šã€‚

ç®€è€Œè¨€ä¹‹ï¼Œå¤§æ¨¡å‹ï¼ˆLLMï¼‰é€šå¸¸è¢«è§†ä¸ºâ€œå¤§è„‘â€ï¼Œè€Œ **Agent åˆ™æ˜¯ç»™è¿™ä¸ªå¤§è„‘è£…ä¸Šäº†â€œæ‰‹è„šâ€å’Œâ€œæ„Ÿå®˜â€**ï¼Œè®©å®ƒèƒ½å¤Ÿä¸ç¯å¢ƒäº¤äº’å¹¶è§£å†³å¤æ‚ä»»åŠ¡ã€‚

ä»¥ä¸‹æ˜¯å¯¹ AI Agent æ¦‚å¿µçš„ç³»ç»Ÿæ€§æ‹†è§£ï¼š

------

## 1. æ ¸å¿ƒå®šä¹‰ï¼šä»€ä¹ˆæ˜¯ Agentï¼Ÿ

**Agent** æ˜¯æŒ‡ä¸€ä¸ªèƒ½å¤Ÿæ„ŸçŸ¥ç¯å¢ƒã€è¿›è¡Œæ¨ç†ã€åˆ¶å®šè®¡åˆ’ï¼Œå¹¶æ‰§è¡ŒåŠ¨ä½œä»¥å®ç°ç‰¹å®šç›®æ ‡çš„è‡ªä¸»ç³»ç»Ÿã€‚

ä¼ ç»Ÿçš„ AI æ¨¡å‹ï¼ˆå¦‚ ChatGPT çš„åŸºç¡€å¯¹è¯æ¨¡å¼ï¼‰æ˜¯è¢«åŠ¨çš„ï¼šä½ ç»™å®ƒè¾“å…¥ï¼Œå®ƒç»™ä½ è¾“å‡ºã€‚

è€Œ Agent æ˜¯**ä¸»åŠ¨**çš„ï¼šä½ ç»™å®ƒä¸€ä¸ªç›®æ ‡ï¼Œå®ƒä¼šè‡ªå·±æƒ³åŠæ³•å»è¾¾æˆã€‚

æ ¸å¿ƒå…¬å¼ï¼š
$$
Agent = LLMï¼ˆå¤§è„‘ï¼‰+ Planningï¼ˆè§„åˆ’ï¼‰+ Memoryï¼ˆè®°å¿†ï¼‰+ Toolsï¼ˆå·¥å…·ä½¿ç”¨ï¼‰
$$


------

## 2. Agent çš„å››å¤§æ ¸å¿ƒç»„ä»¶

æ ¹æ®ç›®å‰ä¸»æµçš„æ¶æ„ï¼ˆå¦‚ Lilian Weng çš„å®šä¹‰ï¼‰ï¼Œä¸€ä¸ªç°ä»£ AI Agent é€šå¸¸åŒ…å«ä»¥ä¸‹å››ä¸ªéƒ¨åˆ†ï¼š

### A. æ ¸å¿ƒå¤§è„‘ (The Brain / Profiling)

é€šå¸¸ç”±å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ‰®æ¼”ã€‚

- **ä½œç”¨ï¼š** è´Ÿè´£ç†è§£è‡ªç„¶è¯­è¨€ã€é€»è¾‘æ¨ç†ã€æ‹†è§£ä»»åŠ¡å’Œå†³ç­–ã€‚
- **ä¾‹å­ï¼š** é¢å¯¹â€œå¸®æˆ‘è®¢ä¸€å¼ å»ä¸Šæµ·çš„ç¥¨â€è¿™ä¸ªæŒ‡ä»¤ï¼ŒLLM è´Ÿè´£åˆ†ææ„å›¾ï¼Œæå–æ—¶é—´ã€åœ°ç‚¹ç­‰å…³é”®ä¿¡æ¯ã€‚

### B. è§„åˆ’ (Planning)

Agent åœ¨è¡ŒåŠ¨å‰éœ€è¦æ€è€ƒâ€œæ€ä¹ˆåšâ€ã€‚

- **å­ç›®æ ‡åˆ†è§£ (Decomposition)ï¼š** å°†ä¸€ä¸ªå¤§çš„æŠ½è±¡ç›®æ ‡ï¼ˆå¦‚â€œå†™ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆâ€ï¼‰æ‹†è§£ä¸ºå¤šä¸ªå¯æ‰§è¡Œçš„å°æ­¥éª¤ï¼ˆç”Ÿæˆä»£ç  -> è¿è¡Œæµ‹è¯• -> ä¿®å¤é”™è¯¯ï¼‰ã€‚
- **åæ€ä¸ä¿®æ­£ (Self-Reflection)ï¼š** Agent ä¼šæ£€æŸ¥è‡ªå·±çš„æ‰§è¡Œç»“æœã€‚å¦‚æœç¬¬ä¸€æ­¥å¤±è´¥äº†ï¼Œå®ƒä¼šé‡æ–°è§„åˆ’ï¼Œè€Œä¸æ˜¯ä¸€æ¡è·¯èµ°åˆ°é»‘ã€‚
  - *å¸¸è§æŠ€æœ¯ï¼š* Chain of Thought (CoT), ReAct (Reasoning + Acting)ã€‚

### C. è®°å¿† (Memory)

ä¸ºäº†å¤„ç†é•¿ä»»åŠ¡ï¼ŒAgent éœ€è¦è®°ä½ä¸Šä¸‹æ–‡ã€‚

- **çŸ­æœŸè®°å¿†ï¼š** ä¸Šä¸‹æ–‡çª—å£ï¼ˆContext Windowï¼‰ï¼Œè®°ä½å½“å‰çš„å¯¹è¯å’Œä¸´æ—¶çš„æ€è€ƒè¿‡ç¨‹ã€‚
- **é•¿æœŸè®°å¿†ï¼š** é€šå¸¸ä½¿ç”¨**å‘é‡æ•°æ®åº“ (Vector Database)**ã€‚Agent å¯ä»¥æŠŠè¿‡å»çš„ç»éªŒã€æ–‡æ¡£æˆ–çŸ¥è¯†åº“å­˜å‚¨èµ·æ¥ï¼Œéœ€è¦æ—¶é€šè¿‡æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG) è°ƒå–ï¼Œå®ç°â€œè¿‡ç›®ä¸å¿˜â€ã€‚

### D. å·¥å…·ä½¿ç”¨ (Tool Use / Action)

è¿™æ˜¯ Agent åŒºåˆ«äºæ™®é€šèŠå¤©æœºå™¨äººçš„å…³é”®ã€‚

- **ä½œç”¨ï¼š** è¿æ¥æ•°å­—ä¸–ç•Œæˆ–ç‰©ç†ä¸–ç•Œã€‚Agent å¯ä»¥è°ƒç”¨ APIã€æµè§ˆç½‘é¡µã€æ‰§è¡Œä»£ç ã€æŸ¥è¯¢æ•°æ®åº“æˆ–æ“ä½œè½¯ä»¶ã€‚
- **ä¾‹å­ï¼š** LLM æœ¬èº«ä¸èƒ½è®¡ç®—å¤æ‚çš„æ•°å­¦é¢˜ï¼Œä½† Agent å¯ä»¥è°ƒç”¨ä¸€ä¸ªâ€œè®¡ç®—å™¨å·¥å…·â€æˆ–è€…æ˜¯ Python è§£é‡Šå™¨æ¥å¾—åˆ°ç²¾ç¡®ç»“æœã€‚

------

## 3. Agent çš„å·¥ä½œæµç¨‹ (The Loop)

ä¸€ä¸ªå…¸å‹çš„ Agent å·¥ä½œæµæ˜¯ä¸€ä¸ªé—­ç¯ç³»ç»Ÿï¼š

1. **æ„ŸçŸ¥ (Perception)ï¼š** æ¥æ”¶ç”¨æˆ·æŒ‡ä»¤ï¼ˆä¾‹å¦‚ï¼šâ€œåˆ†æè¿™å‘¨çš„è‚¡ç¥¨è¶‹åŠ¿â€ï¼‰ã€‚
2. **è§„åˆ’ (Planning)ï¼š** å¤§è„‘æ€è€ƒï¼šâ€œæˆ‘éœ€è¦å…ˆä¸Šç½‘æŸ¥æ•°æ®ï¼Œç„¶åç”¨ Python ç”»å›¾ï¼Œæœ€åå†™æ€»ç»“ã€‚â€
3. **è¡ŒåŠ¨ (Action)ï¼š** è°ƒç”¨æœç´¢å·¥å…·æŸ¥æ•°æ®ï¼Œè°ƒç”¨ä»£ç è§£é‡Šå™¨ç”»å›¾ã€‚
4. **è§‚å¯Ÿ (Observation)ï¼š** è·å–å·¥å…·è¿”å›çš„ç»“æœï¼ˆæ•°æ®è¡¨æ ¼ã€å›¾è¡¨ï¼‰ã€‚
5. **åé¦ˆ/è¿­ä»£ (Feedback)ï¼š** å¦‚æœæ•°æ®ç¼ºå¤±ï¼ŒAgent ä¼šå†³å®šå†æ¬¡æœç´¢ï¼›å¦‚æœæ•°æ®å®Œæ•´ï¼Œåˆ™ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Šã€‚

------

## 4. ä¸ºä»€ä¹ˆ Agent æ˜¯ AI çš„ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Ÿ

| **ç»´åº¦**     | **ä¼ ç»Ÿ LLM (Chatbot)** | **AI Agent**                             |
| ------------ | ---------------------- | ---------------------------------------- |
| **äº¤äº’æ¨¡å¼** | ä¿¡æ¯å’¨è¯¢ (Information) | ä»»åŠ¡æ‰§è¡Œ (Task Execution)                |
| **ä¸»åŠ¨æ€§**   | è¢«åŠ¨å›ç­”               | ä¸»åŠ¨è§„åˆ’ã€è¯•é”™                           |
| **èƒ½åŠ›è¾¹ç•Œ** | ä»…é™äºæ¨¡å‹è®­ç»ƒæ—¶çš„çŸ¥è¯† | å¯é€šè¿‡å·¥å…·æ‰©å±•æ— é™èƒ½åŠ› (è”ç½‘ã€æ“ä½œè½¯ä»¶)  |
| **åº”ç”¨åœºæ™¯** | å†™é‚®ä»¶ã€ç¿»è¯‘ã€é—²èŠ     | è‡ªåŠ¨åŒ–åŠå…¬ã€ä»£ç å¼€å‘ã€å®¢æˆ·æœåŠ¡ã€æ•°æ®åˆ†æ |

------

## 5. å¸¸è§ç±»å‹

1. **å•æ™ºèƒ½ä½“ (Single Agent)ï¼š** ä¸€ä¸ªå…¨èƒ½å‹åŠ©æ‰‹ï¼Œç‹¬è‡ªå®Œæˆä»»åŠ¡ï¼ˆå¦‚ AutoGPTï¼‰ã€‚
2. **å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ (Multi-Agent Systems - MAS)ï¼š** å¤šä¸ªè§’è‰²åŒ–çš„ Agent åä½œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª Agent æ‰®æ¼”â€œäº§å“ç»ç†â€ï¼Œä¸€ä¸ªæ‰®æ¼”â€œç¨‹åºå‘˜â€ï¼Œä¸€ä¸ªæ‰®æ¼”â€œæµ‹è¯•å‘˜â€ï¼Œå®ƒä»¬äº’ç›¸å¯¹è¯æ¥å¼€å‘è½¯ä»¶ï¼ˆå¦‚ MetaGPT, ChatDevï¼‰ã€‚

## æ€»ç»“

å¦‚æœæŠŠäººå·¥æ™ºèƒ½æ¯”ä½œä¸€å®¶å…¬å¸ï¼Œ**LLM æ˜¯é‚£æœ¬åšåšçš„â€œå‘˜å·¥æ‰‹å†Œâ€**ï¼ˆå……æ»¡äº†çŸ¥è¯†ä½†ä¸ä¼šåŠ¨ï¼‰ï¼Œè€Œ **Agent å°±æ˜¯é‚£ä¸ªç†Ÿè¯»æ‰‹å†Œã€ä¼šç”¨ç”µè„‘ã€èƒ½æ‰“ç”µè¯ã€èƒ½è§£å†³å…·ä½“é—®é¢˜çš„â€œä¼˜ç§€å‘˜å·¥â€**ã€‚

## AI Agent å·¥ä½œæµå›¾

1. **é€»è¾‘æµç¨‹å›¾ (Flowchart)**ï¼šå±•ç¤º Agent å¦‚ä½•æ€è€ƒã€å¾ªç¯æ‰§è¡Œå·¥å…·å¹¶å¾—å‡ºç»“è®ºï¼ˆæ ¸å¿ƒæ˜¯ ReAct æ¨¡å¼ï¼‰ã€‚
2. **æ—¶åºå›¾ (Sequence Diagram)**ï¼šå±•ç¤ºå„ä¸ªç»„ä»¶ï¼ˆç”¨æˆ·ã€Agentã€LLMã€å·¥å…·ï¼‰ä¹‹é—´çš„æ•°æ®äº¤äº’é¡ºåºã€‚

------

### 1. Agent æ ¸å¿ƒæ€è€ƒå¾ªç¯ (The Loop)

è¿™ä¸ªå›¾å±•ç¤ºäº† Agent æœ€æ ¸å¿ƒçš„ç‰¹å¾ï¼š**â€œæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿâ€çš„å¾ªç¯ (Think-Act-Observe Loop)**ã€‚

ä»£ç æ®µ

```mermaid
graph TD
    %% å®šä¹‰èŠ‚ç‚¹æ ·å¼
    classDef user fill:#f9f,stroke:#333,stroke-width:2px;
    classDef brain fill:#bbf,stroke:#333,stroke-width:2px;
    classDef tool fill:#bfb,stroke:#333,stroke-width:2px;
    classDef memory fill:#fdd,stroke:#333,stroke-width:2px;

    User([ğŸ‘¤ ç”¨æˆ·è¾“å…¥ User Request]) --> ContextBuilder

    subgraph Agent_System [ğŸ¤– AI Agent Runtime]
        direction TB
        
        ContextBuilder[ğŸ“¥ æ„ŸçŸ¥ & ä¸Šä¸‹æ–‡æ„å»º<br/>Perception] --> CheckMemory
        CheckMemory[(ğŸ§  æ£€ç´¢è®°å¿†/RAG)] --> PromptAugment[æ„å»ºå®Œæ•´ Prompt]
        PromptAugment --> LLM_Core
        
        LLM_Core[âš¡ LLM å¤§è„‘æ¨ç†<br/>Reasoning / Planning] --> Decision{éœ€è¦ä½¿ç”¨å·¥å…·å—?<br/>Decision}
        
        %% å·¥å…·è°ƒç”¨åˆ†æ”¯
        Decision -- Yes: éœ€è¦æ•°æ®/æ“ä½œ --> ToolSelect[ğŸ› ï¸ é€‰æ‹©å·¥å…· & ç”Ÿæˆå‚æ•°<br/>Tool Selection]
        ToolSelect --> ToolExec[âš™ï¸ æ‰§è¡ŒåŠ¨ä½œ<br/>Action Execution]
        ToolExec --> Observation[ğŸ“ è§‚å¯Ÿç»“æœ<br/>Observation]
        
        %% å…³é”®ï¼šè§‚å¯Ÿç»“æœå›ä¼ ç»™å¤§è„‘ï¼Œå½¢æˆé—­ç¯
        Observation --> ContextBuilder
        
        %% ç»“æŸåˆ†æ”¯
        Decision -- No: ä»»åŠ¡å®Œæˆ --> FinalGen[âœ… ç”Ÿæˆæœ€ç»ˆå›å¤<br/>Response Generation]
    end

    FinalGen --> Output([ğŸ è¾“å‡ºç»“æœ Final Output])

    %% åº”ç”¨æ ·å¼
    class User,Output user;
    class LLM_Core,ContextBuilder,PromptAugment,FinalGen brain;
    class ToolSelect,ToolExec,Observation tool;
    class CheckMemory memory;
```

#### æµç¨‹è§£è¯»ï¼š

1. **æ„ŸçŸ¥ (Perception)**: æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶ç»“åˆé•¿æœŸè®°å¿†ï¼ˆRAGï¼‰ã€‚
2. **å†³ç­– (Decision)**: LLM åˆ¤æ–­å½“å‰ä¿¡æ¯æ˜¯å¦è¶³å¤Ÿå›ç­”ï¼Ÿ
   - å¦‚æœä¸å¤Ÿï¼Œè¿›å…¥**å·¥å…·é“¾**ã€‚
   - å¦‚æœå¤Ÿäº†ï¼Œç›´æ¥**ç”Ÿæˆå›ç­”**ã€‚
3. **é—­ç¯ (The Loop)**: æ³¨æ„ `Observation` æŒ‡å‘ `ContextBuilder` çš„ç®­å¤´ã€‚è¿™æ˜¯ Agent å¼ºå¤§çš„åŸå› â€”â€”å®ƒèƒ½çœ‹åˆ°å·¥å…·æ‰§è¡Œçš„ç»“æœï¼ˆæ¯”å¦‚æŠ¥é”™äº†ï¼Œæˆ–è€…æŸ¥åˆ°äº†æ•°æ®ï¼‰ï¼Œç„¶åæ ¹æ®æ–°æƒ…å†µè¿›è¡Œä¸‹ä¸€æ¬¡æ¨ç†ã€‚

------

### 2. ç»„ä»¶äº¤äº’æ—¶åºå›¾ (Sequence Diagram)

è¿™ä¸ªå›¾é€‚åˆå¼€å‘è€…æŸ¥çœ‹ç³»ç»Ÿæ¶æ„ï¼Œå±•ç¤ºäº† Agent å¦‚ä½•ä½œä¸ºâ€œä¸­é—´äººâ€åè°ƒ LLM å’Œå¤–éƒ¨å·¥å…·ã€‚

ä»£ç æ®µ

```mermaid
sequenceDiagram
    autonumber
    participant User as ğŸ‘¤ ç”¨æˆ· (User)
    participant Agent as ğŸ¤– Agent æ§åˆ¶å™¨ (Controller)
    participant Memory as ğŸ—„ï¸ è®°å¿†/å‘é‡åº“ (Memory)
    participant LLM as ğŸ§  å¤§æ¨¡å‹ (LLM)
    participant Tools as ğŸ› ï¸ å¤–éƒ¨å·¥å…· (Tools)

    User->>Agent: å‘é€æŒ‡ä»¤ (e.g. "å¸®æˆ‘æŸ¥ä¸‹æŸå…¬å¸è‚¡ä»·å¹¶ç”»å›¾")
    
    loop æ€è€ƒä¸æ‰§è¡Œå¾ªç¯ (ReAct Loop)
        Agent->>Memory: æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ (RAG)
        Memory-->>Agent: è¿”å›å†å²ä¿¡æ¯/æ–‡æ¡£
        
        Agent->>LLM: å‘é€å½“å‰ä¸Šä¸‹æ–‡ + System Prompt
        note right of LLM: æ€è€ƒï¼šæˆ‘éœ€è¦å…ˆæŸ¥è‚¡ä»·
        LLM-->>Agent: è¿”å›æŒ‡ä»¤: Call Tool "StockAPI"
        
        alt è§¦å‘å·¥å…·è°ƒç”¨
            Agent->>Tools: è°ƒç”¨ get_stock_price("Code")
            Tools-->>Agent: è¿”å› JSON æ•°æ® {"price": 100}
            
            Agent->>Agent: å°†å·¥å…·ç»“æœè¿½åŠ åˆ°å¯¹è¯å†å² (Observation)
            
            Agent->>LLM: å‘é€æ›´æ–°åçš„ä¸Šä¸‹æ–‡ (åŒ…å«åˆšæ‰æŸ¥åˆ°çš„è‚¡ä»·)
            note right of LLM: æ€è€ƒï¼šæ•°æ®æœ‰äº†ï¼Œç°åœ¨å†™ä»£ç ç”»å›¾
            LLM-->>Agent: è¿”å›æŒ‡ä»¤: Call Tool "PythonInterpreter"
            
            Agent->>Tools: æ‰§è¡Œç»˜å›¾ä»£ç 
            Tools-->>Agent: è¿”å›å›¾ç‰‡ URL
        else ä¸éœ€è¦å·¥å…·
            Agent->>Agent: æ ‡è®°ä»»åŠ¡å®Œæˆ
        end
    end

    Agent->>LLM: è¯·æ±‚ç”Ÿæˆæœ€ç»ˆè‡ªç„¶è¯­è¨€å›å¤
    LLM-->>Agent: "è‚¡ä»·èµ°åŠ¿å›¾å·²ç”Ÿæˆ..."
    Agent->>User: è¿”å›æœ€ç»ˆç»“æœ
```