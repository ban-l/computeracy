# 知识点

## 大表数据优化

当MySQL单表记录数过大时，数据库的CRUD性能会明显下降，一些常见的优化措施如下：

1. 限定数据的范围；
2. sql语句+索引；
3. 加缓存；
4. 主从复制，读写分离；
5. 垂直拆分，根据模块的耦合度，将一个大系统分为多个小系统，即分布式系统；
6. 水平切分，针对数据量大的表：
   - 选择一个合理的sharding key；
   - 表结构也要改动，做一定的冗余；
   - 应用也要改动，sql中尽量带sharding key，将数据定位到限定表，而不是扫描全部的表。

## 数据库结构优化

一个好的数据库设计方案对于数据库的性能往往会起到事半功倍的效果。

需要考虑**数据冗余、查询和更新的速度、字段的数据类型**是否合理等多方面的内容。

1. 将字段很多的表分解成多个表：
   1. 对于字段较多的表，如果有些字段的使用频率很低，可以将这些字段分离出来形成新表；
   2. 因为当一个表的数据量很大时，会由于使用频率低的字段的存在而变慢。
2. 增加中间表：
   1. 对于需要经常联合查询的表，可以建立中间表以提高查询效率。
   2. 通过建立中间表，将需要通过联合查询的数据插入到中间表中，然后将原来的联合查询改为对中间表的查询。
3. 增加冗余字段
   1. 设计数据表时应尽量遵循范式理论的规约，尽可能的减少冗余字段，让数据库设计看起来精致、优雅。
   2. 但是，合理的加入冗余字段可以提高查询速度。
   3. 注意，冗余字段的值在一个表中修改了，就要在其它表中更新，否则导致数据不一致。
4. 表的规范化程度越高，表和表之间的关系越多，需要连接查询的情况也就越多，性能也就越差。