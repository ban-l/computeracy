# 数据库cpu飙升问题

1. 当 cpu 飙升到 500%时，先用操作系统命令 **top** 命令观察是不是 MySQLd 占用导致的。
   - 如果不是，找出占用高的进程，并进行相关处理。
2. 如果是 MySQLd 造成的， **show processlist**，查看 session 情况，是不是有消耗资源的  sql 在运行。
3. 找出消耗高的 sql，explain语句的执行计划， 查看index 是否缺失，或者是数据量太大造成的。
4. 一般来说，需要要 kill 掉这些线程，同时观察cpu使用率是否下降等进行相应的调整(索引、改 sql、改内存参数)之后，再重新跑这些 SQL。
5. 也有可能是每个 sql 消耗资源并不多，但是突然之间，有大量的 session 连进来导致 cpu 飙升。
   - 这种情况需要跟应用一起来分析为何连接数会激增，再做出相应的调整，比如说限制连接数等。